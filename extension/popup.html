<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Focus Tracker</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Instrument+Sans:wght@400;500;600&family=Instrument+Serif:ital@1&family=JetBrains+Mono:wght@400;500&display=swap" rel="stylesheet">
  <style>
    *, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }

    /* ‚îÄ‚îÄ Exact same design tokens as dashboard.css ‚îÄ‚îÄ */
    :root {
      --bg:          #f5f3ef;
      --bg-card:     #fdfcfa;
      --bg-raised:   #ffffff;
      --bg-subtle:   #ede9e3;
      --bg-sunken:   #e8e4de;
      --text:        #1c1917;
      --text-2:      #57534e;
      --text-3:      #a8a29e;
      --border:      #e0dbd4;
      --border-2:    #d0cac2;
      --shadow-xs:   0 1px 2px rgba(28,25,23,.05);
      --shadow-sm:   0 2px 8px rgba(28,25,23,.07), 0 1px 2px rgba(28,25,23,.04);
      --shadow-md:   0 6px 20px rgba(28,25,23,.09), 0 2px 6px rgba(28,25,23,.05);
      --accent:      #4f46e5;
      --accent-2:    #4338ca;
      --accent-soft: rgba(79,70,229,.1);
      --accent-grad: linear-gradient(135deg, #4f46e5 0%, #7c3aed 100%);
      --r:           10px;
      --r-lg:        16px;
    }

    /* dark theme ‚Äî mirrors dashboard.css exactly */
    [data-theme="dark"] {
      --bg:          #111210;
      --bg-card:     #18191a;
      --bg-raised:   #1f2022;
      --bg-subtle:   #25272a;
      --bg-sunken:   #0e0f0f;
      --text:        #f2ede8;
      --text-2:      #9c9490;
      --text-3:      #5c5650;
      --border:      #2a2c2e;
      --border-2:    #363a3c;
      --shadow-xs:   0 1px 2px rgba(0,0,0,.3);
      --shadow-sm:   0 2px 8px rgba(0,0,0,.35);
      --shadow-md:   0 6px 20px rgba(0,0,0,.45);
    }

    /* accent overrides ‚Äî identical to dashboard.css */
    [data-accent="blue"]   { --accent:#2563eb; --accent-2:#1d4ed8; --accent-soft:rgba(37,99,235,.1);  --accent-grad:linear-gradient(135deg,#2563eb,#1d4ed8); }
    [data-accent="green"]  { --accent:#16a34a; --accent-2:#15803d; --accent-soft:rgba(22,163,74,.1);  --accent-grad:linear-gradient(135deg,#16a34a,#15803d); }
    [data-accent="purple"] { --accent:#7c3aed; --accent-2:#6d28d9; --accent-soft:rgba(124,58,237,.1); --accent-grad:linear-gradient(135deg,#7c3aed,#6d28d9); }
    [data-accent="red"]    { --accent:#dc2626; --accent-2:#b91c1c; --accent-soft:rgba(220,38,38,.1);  --accent-grad:linear-gradient(135deg,#dc2626,#b91c1c); }
    [data-accent="orange"] { --accent:#ea580c; --accent-2:#c2410c; --accent-soft:rgba(234,88,12,.1);  --accent-grad:linear-gradient(135deg,#ea580c,#c2410c); }
    [data-accent="indigo"] { --accent:#4f46e5; --accent-2:#4338ca; --accent-soft:rgba(79,70,229,.1);  --accent-grad:linear-gradient(135deg,#4f46e5,#7c3aed); }

    body {
      width: 340px;
      font-family: 'Instrument Sans', sans-serif;
      background: var(--bg);
      color: var(--text);
      overflow: hidden;
      -webkit-font-smoothing: antialiased;
      transition: background .25s, color .25s;
    }

    button {
      font-family: 'Instrument Sans', sans-serif;
      cursor: pointer; border: none;
      transition: all .18s;
    }
    button:active:not(:disabled) { transform: scale(.96); }
    button:disabled { opacity: .38; cursor: not-allowed; transform: none !important; }

    /* ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê HEADER ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê */
    .header {
      background: var(--accent-grad);
      padding: 14px 16px 12px;
      display: flex; align-items: center; justify-content: space-between;
      position: relative; overflow: hidden;
    }
    .header::after {
      content: ''; position: absolute;
      top: -28px; right: -28px;
      width: 110px; height: 110px; border-radius: 50%;
      background: rgba(255,255,255,.07); pointer-events: none;
    }
    .header::before {
      content: ''; position: absolute;
      bottom: -18px; left: 50px;
      width: 70px; height: 70px; border-radius: 50%;
      background: rgba(255,255,255,.04); pointer-events: none;
    }

    .brand { display: flex; align-items: center; gap: 8px; position: relative; z-index: 1; }
    .brand-icon {
      width: 28px; height: 28px; border-radius: 7px;
      background: rgba(255,255,255,.18); border: 1px solid rgba(255,255,255,.28);
      display: flex; align-items: center; justify-content: center;
      font-size: 13px; flex-shrink: 0;
    }
    .brand-name {
      font-family: 'Instrument Serif', serif;
      font-style: italic; font-size: 17px;
      color: white; line-height: 1; letter-spacing: -.2px;
    }

    .live-pill {
      display: flex; align-items: center; gap: 5px;
      background: rgba(255,255,255,.14); border: 1px solid rgba(255,255,255,.22);
      border-radius: 99px; padding: 4px 9px 4px 7px;
      font-size: 10px; font-weight: 600; letter-spacing: .06em; text-transform: uppercase;
      color: rgba(255,255,255,.8); position: relative; z-index: 1; transition: all .3s;
    }
    .live-pill.on { background: rgba(255,255,255,.22); border-color: rgba(255,255,255,.38); color: white; }
    .live-dot {
      width: 6px; height: 6px; border-radius: 50%;
      background: rgba(255,255,255,.4); transition: all .3s; flex-shrink: 0;
    }
    .live-pill.on .live-dot {
      background: #4ade80; box-shadow: 0 0 0 3px rgba(74,222,128,.28);
      animation: throb 2s ease-in-out infinite;
    }
    @keyframes throb {
      0%,100% { box-shadow: 0 0 0 3px rgba(74,222,128,.28); }
      50%      { box-shadow: 0 0 0 6px rgba(74,222,128,.08); }
    }

    /* ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê STATS ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê */
    .stats-row {
      display: grid; grid-template-columns: 1fr 1fr;
      gap: 1px; background: var(--border); border-bottom: 1px solid var(--border);
    }
    .stat-box { background: var(--bg-card); padding: 11px 14px; transition: background .25s; }
    .stat-lbl {
      font-size: 10px; font-weight: 600; letter-spacing: .07em;
      text-transform: uppercase; color: var(--text-3); margin-bottom: 3px;
    }
    .stat-val {
      font-family: 'JetBrains Mono', monospace;
      font-size: 20px; font-weight: 500; color: var(--text);
      line-height: 1; letter-spacing: -.5px;
    }
    .stat-val.accent { color: var(--accent); }

    /* ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê FOCUS SECTION ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê */
    .focus-section {
      padding: 12px 14px 10px;
      background: var(--bg-card); border-bottom: 1px solid var(--border);
      transition: background .25s;
    }

    .state-bar {
      display: flex; align-items: center; justify-content: space-between;
      background: var(--bg-subtle); border: 1px solid var(--border);
      border-radius: var(--r); padding: 9px 11px; margin-bottom: 9px;
      transition: all .25s;
    }
    .state-bar.active { background: rgba(22,163,74,.07);  border-color: rgba(22,163,74,.22); }
    .state-bar.locked { background: rgba(220,38,38,.06);  border-color: rgba(220,38,38,.18); }

    .state-left { display: flex; align-items: center; gap: 7px; }
    .state-icon { font-size: 13px; line-height: 1; }
    .state-title { font-size: 12px; font-weight: 600; color: var(--text); line-height: 1.2; }
    .state-sub   { font-size: 10px; color: var(--text-3); margin-top: 1px; }

    .state-badge {
      font-family: 'JetBrains Mono', monospace;
      font-size: 9px; font-weight: 700; letter-spacing: .08em; text-transform: uppercase;
      padding: 3px 8px; border-radius: 99px;
      background: var(--bg-sunken); color: var(--text-3); border: 1px solid var(--border);
      transition: all .25s;
    }
    .state-badge.on  { background: rgba(22,163,74,.1);  color: #16a34a; border-color: rgba(22,163,74,.25); }
    .state-badge.err { background: rgba(220,38,38,.08); color: #dc2626; border-color: rgba(220,38,38,.2);  }

    .btn-row { display: grid; grid-template-columns: 1fr auto auto; gap: 6px; }

    .btn-start {
      padding: 9px 10px;
      background: var(--accent-grad); color: white;
      font-size: 12px; font-weight: 600; border-radius: var(--r);
      box-shadow: 0 2px 10px rgba(0,0,0,.12);
      display: flex; align-items: center; gap: 4px;
    }
    .btn-start:hover:not(:disabled) { opacity: .92; transform: translateY(-1px); box-shadow: 0 4px 14px rgba(0,0,0,.18); }

    .btn-hard {
      padding: 9px 11px;
      background: rgba(220,38,38,.07); border: 1px solid rgba(220,38,38,.18);
      border-radius: var(--r); color: #dc2626;
      font-size: 12px; font-weight: 600; white-space: nowrap;
      display: flex; align-items: center; gap: 4px;
    }
    .btn-hard:hover:not(:disabled) { background: rgba(220,38,38,.13); transform: translateY(-1px); }

    .btn-stop {
      padding: 9px 11px;
      background: var(--bg-subtle); border: 1px solid var(--border);
      border-radius: var(--r); color: var(--text-2);
      font-size: 12px; white-space: nowrap;
    }
    .btn-stop:hover:not(:disabled) { background: var(--bg-sunken); border-color: var(--border-2); color: var(--text); }

    .locked-banner {
      display: none; margin-top: 8px; padding: 7px 11px;
      background: rgba(220,38,38,.06); border: 1px solid rgba(220,38,38,.16);
      border-radius: var(--r); font-size: 11px; font-weight: 500;
      color: #dc2626; text-align: center;
    }
    .locked-banner.show { display: block; }

    /* ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê HARD FOCUS TIME PICKER ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê */
    .time-picker {
      display: none; margin-top: 9px;
      border: 1px solid var(--border); border-radius: var(--r-lg);
      overflow: hidden; box-shadow: var(--shadow-md);
      background: var(--bg-raised);
      animation: pop-in .2s cubic-bezier(.34,1.56,.64,1);
    }
    .time-picker.open { display: block; }
    @keyframes pop-in {
      from { opacity:0; transform: scale(.95) translateY(-4px); }
      to   { opacity:1; transform: none; }
    }

    /* top band ‚Äî uses accent gradient so it matches whatever theme */
    .picker-top {
      background: var(--accent-grad);
      padding: 12px 14px 11px;
      display: flex; align-items: flex-end; justify-content: space-between;
      position: relative; overflow: hidden;
    }
    .picker-top::after {
      content: ''; position: absolute; top: -20px; right: -20px;
      width: 80px; height: 80px; border-radius: 50%;
      background: rgba(255,255,255,.07); pointer-events: none;
    }
    .picker-top-lbl {
      font-size: 10px; font-weight: 600; letter-spacing: .08em;
      text-transform: uppercase; color: rgba(255,255,255,.6); margin-bottom: 3px;
    }
    .picker-duration-wrap { display: flex; align-items: baseline; gap: 3px; }
    .picker-num {
      font-family: 'JetBrains Mono', monospace;
      font-size: 30px; font-weight: 500; color: white;
      line-height: 1; letter-spacing: -.5px; transition: all .15s;
    }
    .picker-unit { font-size: 14px; color: rgba(255,255,255,.65); font-weight: 400; }
    .picker-endtime {
      font-size: 10px; color: rgba(255,255,255,.55);
      text-align: right; position: relative; z-index: 1;
    }

    /* preset chips */
    .picker-presets {
      display: grid; grid-template-columns: repeat(5,1fr);
      gap: 5px; padding: 10px 11px 9px;
      border-bottom: 1px solid var(--border);
    }
    .preset {
      padding: 6px 2px; background: var(--bg-subtle); border: 1px solid var(--border);
      border-radius: 7px; font-size: 11px; font-weight: 600;
      color: var(--text-2); text-align: center; cursor: pointer; transition: all .13s;
    }
    .preset:hover { background: var(--accent-soft); border-color: var(--accent); color: var(--accent); }
    .preset.sel   {
      background: var(--accent-soft); border-color: var(--accent);
      color: var(--accent); box-shadow: 0 0 0 1.5px var(--accent) inset;
    }

    /* slider */
    .picker-slider { padding: 10px 13px 11px; border-bottom: 1px solid var(--border); }
    .slider-row {
      display: flex; justify-content: space-between; align-items: center; margin-bottom: 8px;
    }
    .slider-lbl {
      font-size: 10px; font-weight: 600; letter-spacing: .07em;
      text-transform: uppercase; color: var(--text-3);
    }
    .slider-cur {
      font-family: 'JetBrains Mono', monospace;
      font-size: 11px; font-weight: 500; color: var(--accent);
    }

    input[type="range"] {
      -webkit-appearance: none; appearance: none;
      width: 100%; height: 4px; border-radius: 99px;
      outline: none; cursor: pointer;
      /* filled portion set via JS */
      background: var(--bg-sunken);
    }
    input[type="range"]::-webkit-slider-thumb {
      -webkit-appearance: none; appearance: none;
      width: 17px; height: 17px; border-radius: 50%;
      background: var(--bg-raised); border: 3px solid var(--accent);
      box-shadow: 0 1px 6px rgba(0,0,0,.15); cursor: pointer;
      transition: transform .15s, box-shadow .15s;
    }
    input[type="range"]::-webkit-slider-thumb:hover { transform: scale(1.2); }
    input[type="range"]::-moz-range-thumb {
      width: 17px; height: 17px; border-radius: 50%;
      background: var(--bg-raised); border: 3px solid var(--accent); cursor: pointer;
    }

    /* footer */
    .picker-footer { display: flex; gap: 6px; padding: 9px 11px 11px; }
    .picker-cancel {
      flex: 1; padding: 8px;
      background: var(--bg-subtle); border: 1px solid var(--border);
      border-radius: var(--r); font-size: 12px; color: var(--text-2);
    }
    .picker-cancel:hover { background: var(--bg-sunken); }
    .picker-confirm {
      flex: 2; padding: 8px;
      background: var(--accent-grad); border-radius: var(--r);
      font-size: 12px; font-weight: 600; color: white;
      box-shadow: 0 2px 8px rgba(0,0,0,.12);
      display: flex; align-items: center; justify-content: center; gap: 5px;
    }
    .picker-confirm:hover { opacity: .92; transform: translateY(-1px); box-shadow: 0 4px 14px rgba(0,0,0,.18); }

    /* ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê BOTTOM ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê */
    .bottom { padding: 10px 14px 12px; background: var(--bg-card); transition: background .25s; }
    .btn-dashboard {
      width: 100%; padding: 9px 13px;
      background: var(--bg-subtle); border: 1px solid var(--border);
      border-radius: var(--r); color: var(--text-2);
      font-size: 12px; font-weight: 500;
      display: flex; align-items: center; gap: 7px; transition: all .18s;
    }
    .btn-dashboard .arrow { margin-left: auto; color: var(--text-3); transition: transform .18s, color .18s; }
    .btn-dashboard:hover {
      background: var(--accent-soft); border-color: var(--accent);
      color: var(--accent); transform: translateY(-1px); box-shadow: var(--shadow-xs);
    }
    .btn-dashboard:hover .arrow { transform: translateX(3px); color: var(--accent); }
  </style>
</head>
<body>

  <!-- HEADER -->
  <div class="header">
    <div class="brand">
      <div class="brand-icon">‚è±</div>
      <div class="brand-name">Focus Tracker</div>
    </div>
    <div class="live-pill" id="statusIndicator">
      <div class="live-dot"></div>
      <span id="liveLabel">Idle</span>
    </div>
  </div>

  <!-- STATS -->
  <div class="stats-row">
    <div class="stat-box">
      <div class="stat-lbl">Time tracked</div>
      <div class="stat-val" id="totalTime">‚Äî</div>
    </div>
    <div class="stat-box">
      <div class="stat-lbl">Productivity</div>
      <div class="stat-val accent" id="productivityScore">‚Äî</div>
    </div>
  </div>

  <!-- FOCUS -->
  <div class="focus-section">

    <div class="state-bar" id="focusStateBar">
      <div class="state-left">
        <div class="state-icon" id="focusStateIcon">‚≠ï</div>
        <div>
          <div class="state-title" id="focusBtn">Focus Mode</div>
          <div class="state-sub"   id="focusSubtext">Not active</div>
        </div>
      </div>
      <div class="state-badge" id="focusBadge">OFF</div>
    </div>

    <div class="btn-row">
      <button class="btn-start" id="startFocus">‚ñ∂ Start Focus</button>
      <button class="btn-hard"  id="hardFocus">üîí Hard Focus</button>
      <button class="btn-stop"  id="stopFocus">‚è∏ Stop Focus</button>
    </div>

    <div class="locked-banner" id="lockedBanner">üîí Hard focus active ‚Äî cannot stop early</div>

    <!-- In-popup hard focus time picker ‚Äî no native prompt() -->
    <div class="time-picker" id="timePicker">

      <div class="picker-top">
        <div>
          <div class="picker-top-lbl">Hard Focus Duration</div>
          <div class="picker-duration-wrap">
            <span class="picker-num" id="pickerNum">25</span>
            <span class="picker-unit">min</span>
          </div>
        </div>
        <div class="picker-endtime" id="pickerEndTime"></div>
      </div>

      <div class="picker-presets">
        <div class="preset" data-min="5">5m</div>
        <div class="preset" data-min="15">15m</div>
        <div class="preset sel" data-min="25">25m</div>
        <div class="preset" data-min="45">45m</div>
        <div class="preset" data-min="60">1h</div>
      </div>

      <div class="picker-slider">
        <div class="slider-row">
          <div class="slider-lbl">Custom</div>
          <div class="slider-cur" id="sliderCur">25 min</div>
        </div>
        <input type="range" id="durationSlider" min="5" max="120" step="5" value="25">
      </div>

      <div class="picker-footer">
        <button class="picker-cancel" id="pickerCancel">Cancel</button>
        <button class="picker-confirm" id="pickerConfirm">üîí Lock &amp; Start</button>
      </div>

    </div>

  </div>

  <!-- DASHBOARD -->
  <div class="bottom">
    <button class="btn-dashboard" id="openDashboard">
       Open Full Dashboard
      <span class="arrow">‚Üí</span>
    </button>
  </div>

  <script src="config.js"></script>
  <script src="popup.js"></script>
</body>
</html>